<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Formation AngularJS - Découverte du framework</title>

        <meta name="description" content="Formation AngularJS - Découverte du framework">
        <meta name="author" content="Bertrand Gaillard">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/beige.css" id="theme">

        <!-- Code syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>
        <style>
        .reveal pre code {
            //max-height: 500px;
        }
        .reveal blockquote {
            width: 90%;
        }
        .reveal pre {
            font-size: .45em;
        }
        .reveal p > code,
        .reveal blockquote > code,
        .reveal li > code {
            color: #8b743d;
        }
        </style>
    

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                
                  <section>
                    <h1>Formation AngularJS</h1>
                    <h2>Découverte du framework</h2>
                    <small><a href="http://bertrandg.github.io/">Bertrand GAILLARD</a></small>
                  </section>
                
                
                
                <section>
                    <section>
                        <h1>Déclaratif plutôt qu’impératif</h1>
                    </section>
                    
                    <section>
                        <p>BackboneJS = impératif, le JS commande l'HTML</p>
                        <p class="fragment">AngularJS = déclaratif, le HTML commande le JS</p>
                        <br>
                        <p class="fragment">impératif = difficile à organiser et maintenir</p>
                        <p class="fragment">déclaratif = plus simple à lire et moins de code</p>
                    </section>
                    
                    <section>
                        <h2>Plus maintenable</h2>
                        <ul>
                            <li>
                                <p><code>#id</code> et <code>.class</code> ne sont plus utilisés dans le JS.</p>
                                <p>Dans le code HTML, on a:</p>
                                <ul>
                                    <li class="fragment">Pour le CSS, on a les <code>#id</code> et <code>.class</code></li>
                                    <li class="fragment">Pour le JS, on a les directives Angular ou personnalisées</li>
                                </ul>
                            </li>
                            <li>
                                <p class="fragment">CSS et JS ne sont plus liés du tout.</p>
                                <p class="fragment">Aucun/moins de risque d'erreur de:</p>
                                <ul>
                                    <li class="fragment">Casser des sélécteurs JS en travaillant sur le style</li>
                                    <li class="fragment">Casser des sélécteurs CSS en travaillant sur le javascript</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                </section>
                
                
                
                <section>
                    <section>
                        <h1>Etendre le language HTML</h1>
                    </section>
                    
                    <section>
                    	<ul>
	                        <li>Utilisation de nouvelles balises et attributs HTML</li>
	                        <li class="fragment">Angular parse le DOM et interpréte ces éléments</li>
	                        <li class="fragment">Pas de syntaxe de template spéciale, c'est du HTML!</li>
                    	</ul>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h1>C'est quoi une application AngularJS?</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>
                                <p>Une partie du DOM sur laquelle on a mis l'attribut <code>ng-app</code>:</p>
<pre><code><div ng-app="testApp">..</div></code></pre>
                            </li>
                            <li class="fragment">
                                <p>Autre moyen de démarrer une application en passant par javascript:</p>
<pre><code><div id="divApp">..</div></code></pre>
<pre><code>angular.bootstrap(document.getElementById('divApp'), ['testApp']);</code></pre>
                            </li>
                            <li class="fragment">
                                <p>Possibilité de mettre plusieurs applications sur la même page.</p>
                            </li>
                            <li class="fragment">
                                <p>Parse la partie du DOM et exécute les directives qu'il trouve en ajoutant des templates, exécutant du JS,..</p>
                            </li>
                        </ul>
                    </section>
                    
                </section>
                
                
                <section>
                    <section>
                        <h1>Un framework MVC</h1>
                    </section>
                    
                    <section>
                        <img data-src="images/mvc.png"/>
                        <a href="http://swiip.github.io/yeoman-angular" target="_blank">http://swiip.github.io</a>
                    </section>
                    
                    <section>
                        <h2>Les controlleurs et les scopes</h2>
                        
                        <ul>
                            <li>Toujours liés entre eux.</li>
                            <li>Le scope est la glue entre controlleur et vue.</li>
                            <li>Le scope est un simple objet JS sur lequel on fait des bindings dans la vue.</li>
                            <li>Imbrication des <code>controlleurs</code>/<code>scopes</code>.</li>
                            <li>Pour chaque <code>ngApp</code>, un <code>$rootScope</code> est créé, puis chaque controlleur crée un descendant, ce qui créé une arborescence.</li>
                        </ul>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h1>Les directives</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Permet d'étendre le language HTML.</li>
                            <li>Permet d'encapsuler du JS et de l'HTML dans une "boite noire".</li>
                            <li>Va dans le sens des futurs standards du web (WebComponents, Polymer).</li>
                            <li>Génial pour la réutilisation, le partage, le travail en équipe, les tests,..</li>
                            <li>Une des parties les plus puissantes mais aussi difficiles.</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>Directives peuvent prendre 4 formes:</h2>
                        <ul>
                            <li>
                                Elément/Tag
                                <pre><code><my-directive></my-directive></code></pre>
                            </li>
                            <li>
                                Attribut
                                <pre><code><span my-directive></span></code></pre>
                            </li>
                            <li>
                                Commentaire
                                <pre><code><!-- directive: my-directive --></code></pre>
                            </li>
                            <li>
                                Classe
                                <pre><code><span class="my-directive"></span></code></pre>
                            </li>
                        </ul>
                    </section>
                        
                    <section>
                        <ul>
                            <li>directives natives commencent par ng- (conventions)</li>
                            <li>bien de mettre son prefix (conventions)</li>
                            <li>avec des tirets dans l'HTML (ng-click) et en camelCase en JS (ngClick)</li>
                            <li>possibilité de écrire sous différentes formes dans l'HTML:</li>
                        </ul>
                        
                        <pre><code>
<span ng-bind="name"></span>
<span ng:bind="name"></span>
<span ng_bind="name"></span>
<span data-ng-bind="name"></span>
<span x-ng-bind="name"></span>
                        </code></pre>
                    </section>
                        
                    <section>
                        <h2>Directives simples:</h2>
                        <ul>
                            <li>ng-bind / {{ }}</li>
                            <li>ng-click</li>
                            <li>ng-class</li>
                            <li>ng-show / ng-hide</li>
                            <li>ng-init</li>
                            <li>ng-model</li>
                            <li>ng-focus</li>
                        </ul>
                    </section>
                        
                    <section>
                        <h2>Directives créant un nouveau scope:</h2>
                        <ul>
                            <li>ng-controller</li>
                            <li>ng-if</li>
                            <li>ng-include</li>
                            <li>ng-switch</li>
                            <li>ng-repeat</li>
                        </ul>
                    </section>
                </section>
                
                
                
                
                <section>
                    <section>
                        <h1>Les modules</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Permet un découpage de l'application.</li>
                            <li class="fragment">Découpage par fonctionnalité préconisé.</li>
                            <li class="fragment">Ne sert pas de namespace.</li>
                            <li class="fragment">Le framework lui-même découpé en modules: <code>ngRoute</code>, <code>ngAnimate</code>, <code>ngMock</code>,..</li>
                            <li class="fragment">Tous instanciés au démarrage (pas de lazy loading)</li>
                        </ul>
                        <br>
                        <div class="fragment">
                            <p>Exemple de déclaration de module:</p>
                            <pre><code>angular.module('myapp', ['myapp.feature1'
                        'myapp.feature2',
                        'ng-route',
                        'ng-animate'
                        'ui-router']);</code></pre>
                        </div>
                    </section>
                    
                    <section>
                        <p>Tous les controlleurs, directives, filters et services sont déclarées sur un module.</p>
                        
                        <p>Exemple:</p>
                        <pre><code>angular.module('myapp', ['myapp.utils', 'myapp.gallery']);
angular.module('myapp').controller('HomeCtrl', function() {});
angular.module('myapp').service('myService', function() {});

angular.module('myapp.gallery', []);
angular.module('myapp.gallery').controller('GalleryCtrl', function() {});

angular.module('myapp.utils', []);
angular.module('myapp.utils').constant('myFilter', {});
angular.module('myapp.utils').filter('myFilter', function() {});</code></pre>
                    </section>
                    
                    <section>
                        <h2>Au chargement de chaque module:</h2>
                        
                        <ul>
                            <li>Exécution des <code>config()</code> puis des <code>run()</code>.</li>
                            <li>On peut affecter autant de <code>config()</code> et de <code>run()</code></li>
                            <li>Exécuté avant tous les controlleurs, directives, filtres,..</li>
                        </ul>
                        
                        <pre><code>angular.module('myapp', []);
                        
angular.module('myapp').config(function($httpProvider) {
    // Injection des providers des services
    // (objets servant en interne à créer les instances des services)
    // et de les configurer avant leur instanciation
    $httpProvider.defaults.headers.common['Access-Control-Max-Age'] = '1728000';
    $httpProvider.defaults.headers.common['Accept'] = 'application/json, text/javascript';
    $httpProvider.defaults.headers.common['Content-Type'] = 'application/json; charset=utf-8';
});

angular.module('myapp').run(function($http) {
  // Injection des instances des services pour utilisation
  $http.post('/someUrl', {msg:'appStart'});
});</code></pre>
                        
                    </section>
                </section>
                
                
                
                <section>
                    <section>
                        <h1>Les services</h1>
                    </section>
                        
                    <section>
                        <ul>
                            <li>Un service = simple objet JS avec propriétés et méthodes</li>
                            <li>Utilise l'injection de dépendances.</li>
                            <li>Créé une seule fois lors du premier appel (Singleton).</li>
                            <li>Réutilisé lors des suivants pour toute la durée de vie de la SPA.</li>
                            <li>Accessible de partout quelque soit le module sur lequel ils sont créés ou appelés.</li>
                            <li>Peut être injecté dans controlleurs, filtres, services,..</li>
                            <li>Utilisation à volonté pour alléger au maximum les controlleurs.</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>Fonctionnement interne de DI</h2>
                        <ul>
                            <li>Chaque service vient avec un provider qui sert à le créer.</li>
                            <li>A l'initialisation d'un module, tous les providers des services sont réferencés.</li>
                            <li>C'est seulement lors de sa première injection que l'instance du service est créée grâce à son provider.</li>
                            <li>Lors des injections suivantes, Angular fournit directement l'instance, plus besoin du provider.</li>
                        </ul>
                        
                        <blockquote>Dans la pratique, chaque provider posséde une méthode <code>$get</code> qui retourne l'instance et peut comporter des propriétés ou méthodes servant à configurer l'instanciation du service associé.</blockquote>
                    </section>
                    
                    <section>
                        <h2>Différentes déclarations de services</h2>
                        <p>Il existe 5 méthodes pour déclarer un service mais dans tous les cas, ils s'injectent et s'utilisent de la même manière et il en existe toujours une seule instance.</p>
                        <ul>
                            <li>module.provider()</li>
                            <li>module.factory()</li>
                            <li>module.service()</li>
                            <li>module.value()</li>
                            <li>module.constant()</li>
                        </ul>
                        <p>Un <code>service()</code> est juste une manière plus facile d’écrire une <code>factory()</code>, qui est juste une manière plus simple d’écrire un <code>provider()</code>.</p>
                    </section>
                    
                    <section>
                        <h2>1/5: PROVIDER()</h2>
                        <ul>
	                        <li>Permet de paramétrer le service au démarrage du module.</li>
	                        <li>Fonction <code>$get</code> obligatoire retournant l'instance du service.</li>
                        </ul>
                    
                        <pre><code>app.provider('MyService', function() {
    var scale = 1;
    
    this.setScale = function(newScale) {
      scale = newScale;
    };
    
    this.$get = function ($window) {
        return {
            getScreenWidth: function() {
                return $window.innerWidth * scale;
            },
            getScreenHeight: function() {
                return $window.innerHeight * scale;
            }
        };
    };
});

app.config(function(MyServiceProvider) {
  MyServiceProvider.setScale(10);
});

app.controller('AppCtrl', function($scope, MyService) {
  var _width = MyService.getScreenWidth();
});</code></pre>
                    </section>
                    
                    <section>
                        <h2>2/5: FACTORY()</h2>
                        <ul>
	                        <li>Simplification de la méthode <code>provider()</code>.</li>
	                        <li>Equivalent à la méthode <code>$get</code> précédente.</li>
	                        <li>Provider automatiquement créé par Angular.</li>
                        </ul>
                        
                        <pre><code>app.factory('MyService', function($window) {
    var scale = 1;
    
    return {
        getScreenWidth: function() {
            return $window.innerWidth * scale;
        },
        getScreenHeight: function() {
            return $window.innerHeight * scale;
        }
    };
});

app.controller('AppCtrl', function($scope, MyService) {
  var _width = MyService.getScreenWidth();
});</code></pre>
                    </section>
                    
                    <section>
                        <h2>3/5: SERVICE()</h2>
                        <ul>
	                        <li>Simplification de la méthode <code>factory()</code>.</li>
	                        <li>Fonction directement instanciée avec un <code>new</code> pour créer l'instance du service.</li>
	                        <li>Pas besoin de <code>return</code> un objet, tout ce qui est attaché à <code>this</code> sera accessible par le biais du service.</li>
                        </ul>
                        
                        <pre><code>app.service('MyService', function($window) {
    var scale = 1;
    
    this.getScreenWidth = function() {
        return $window.innerWidth * scale;
    };
    
    this.getScreenHeight = function() {
        return $window.innerHeight * scale;
    }
});

app.controller('AppCtrl', function($scope, MyService) {
  var _width = MyService.getScreenWidth();
});</code></pre>
                    </section>
                    
                    <section>
                        <h2>4/5: VALUE()</h2>
                        <ul>
	                        <li>Permet de stocker un objet JS de type <code>object</code> ou bien de type primitif (<code>booléen</code>, <code>string</code>, <code>number</code>).</li>
	                        <li>Inaccessible par les <code>provider</code> lors de la phase de configuration du module.</li>
	                        <li>Peut être modifié pendant l'éxecution de l'application.</li>
                        </ul>
                        
                        <pre><code>app.value('GoogleMapAPI_KEY', '5VUhR4kqvVvhXRH4BIAN')

app.value('VideoData', {
    title: 'Ters Akan şelale!',
    description: 'Bu işte bir yanlışlık var diye İngiltere',
    url: 'http://www.dailymotion.com/video/x28i2n3_ters-akan-selale_news'
})
</code></pre>
                    </section>
                    
                    <section>
                        <h2>5/5: CONSTANT()</h2>
                        <ul>
                        	<li>Fonctionne comme <code>value()</code> mais est accessible lors de la phase de configuration du module.</li>
                        	<li>Malgré leur nom, elles peuvent être modifiée.</li>
                        </ul>
                        
                        <pre><code>app.constant('UselessData', {
    scale: 42
});

app.config(function(MyServiceProvider, UselessData) {
  MyServiceProvider.setScale(UselessData.scale);
});
</code></pre>
                    </section>
                    
                    <section>
                    <h2>Exemple de déclaration de services:</h2>
                    
<pre><code>playerApp.value('Params', {
  URL_API: 'https://api.dailymotion.com/videos',
  URL_EMBED: 'http://www.dailymotion.com/embed/video',
  VIDEOS_PER_PAGE: 12,
  VIDEOS_AUTOPLAY: true,
});

playerApp.factory('Dailymotion', function($http, $sce, Params) {
  var getApiUrl = function(terms, page) {
      var api_params =  '?fields=id,title,description,duration_formatted,created_time&sort=relevance';
      var api_limit =   '&limit=' + Params.VIDEOS_PER_PAGE;
      var api_page =    '&page=' + page;
      var api_search =  '&search=' + terms.split(' ').join('+');
      var api_jsonp =   '&callback=JSON_CALLBACK';
    
    return Params.URL_API + api_params + api_limit + api_page + api_search + api_jsonp;
  };
  
  var Service = {
    getResults: function(terms, page) {
      return $http({
        method: 'JSONP',
        url: getApiUrl(terms, page),
        cache: true,
        transformResponse: function (data, headers) {
          data.nbPages = Math.ceil(data.total / data.limit);
          return data;
        }
      });
    },
    
    getIframeUrl: function(videoId) {
          var url = Params.URL_EMBED + '/' + videoId + '?autoPlay=' + Params.VIDEOS_AUTOPLAY;
          return $sce.trustAsResourceUrl(url);
    }
  };
  
  return Service;
});</code></pre>
                    </section>
                        
                        
                    <section>
                    	<p>Exemple d'utilisation de services:</p>
                    	
<pre><code>playerApp.controller('VideoPlayerModalCtrl', function($scope, $modalInstance, Dailymotion, video) {
  $scope.video = video;
  $scope.iframeUrl = Dailymotion.getIframeUrl(video.id);
  
  $scope.close = function () {
    $modalInstance.close();
  };
});</code></pre>
						<blockquote>En pratique, la méthode <code>provider()</code> est celle qui convient et qui est utilisé dans la plupart du cas.</blockquote>
                    </section>
                        
                        
                    <section>
                        <h2>AngularJS comprend de nombreux services.</h2>
                        
                        <ul>
                            <li>Commencent tous par $ (conventions)</li>
                            <li>Couche d'abstraction utile pour fonctionner dans l'écosystéme AngularJs et pour être mockée lors des tests</li>
                        </ul>
                        
                        <p>$scope, $http, $location, $filter, $window, $timeout, $interval,..</p>
                    </section>
                        
                </section>
                
                
                
                
                <section>
                    <section>
	                    <h1>Les filtres</h1>
                    </section>
                        
                    <section>
                    	<ul>
		                    <li>Utilisation similaires à Twig.</li>
		                    <li>Stateless = si la données à transformer ne change pas, le filtre ne sera pas réexeutée.</li>
		                    <li>Utilisation en HTML ou en JS.</li>
		                    <li>Filtres natif: date, uppercase, json</li>
                    	</ul>
                    </section>
                        
                    <section>
                    	<h2>Création d'un filtre:</h2>
	                    <pre><code>app.filter('truncate', function() {
  return function(str, nbChar) {
    return str.substring(0, nbChar);
  };
});
	                    </code></pre>
                    </section>
                        
                    <section>
                    	<h2>Utilisation HTML d'un filtre:</h2>
	                    <pre><code><p>{{ description | truncate:10 }}</p>
<p ng-bind="description | truncate:10"></p></code></pre>
                    </section>
                        
                    <section>
                    	<h2>Utilisation JS d'un filtre:</h2>
	                    <pre><code>app.controller('MainCtrl', function($scope, $filter) {
  var longText = 'Trés long texte, trés long texte, trés long texte';
  
  $scope.filteredText = $filter('truncate')(longText, 10);
});</code></pre>
	                    <pre><code>app.controller('MainCtrl', function($scope, truncateFilter) {
  var longText = 'Trés long texte, trés long texte, trés long texte';
  
  $scope.filteredText = truncateFilter(longText, 10);
});</code></pre>
                    </section>
                </section>
                
                <section>
                    <section>
	                    <h1>Les promesses</h1>
                    </section>
                    
                    <section>
                    	<ul>
		                    <li>trés utilisée dans l'écosystéme AngularJS</li>
		                    <li>Plus souple que les callbacks</li>
		                    <li>Possibilité des les imbriquées</li>
		                    <li>Gestion des erreurs</li>
		                    <li>Utilisation du service $q</li>
                    	</ul>
                    </section>
                    
                    <section>
                    <pre><code>
                    angular.module('myapp').service('PhotoList', function($q, Flickr) {
                        return {
                            get: function(terms) {
                                var deferred = $q.defer();
                                
                                Flickr.getPhotos(terms).then(function(response) {
                                    deferred.resolve(response.data)
                                }, function(error) {
                                    deferred.reject(error);
                                }, function(event) {
                                    deferred.notify({state: 'loading', progress: parseInt(20 + 80 * event.loaded / event.total) });
                                });
                                
                                return deferred.promise;
                            }
                        };
                    });
                    </code></pre>
                    </section>
                    
                </section>
                
                
                
                <section>
                    <section>
	                    <h1>Le routing</h1>
                    </section>
                    
                    <section>
                    	<ul>
		                    <li>Module <code>ngRoute</code> trés basique, pas de vue imbriquées..</li>
		                    <li>Ui-router, lib remplaçante trés poussée</li>
		                    <li>AngularJS 1.4 pour trés bientôt avec un nouveau router</li>
                    	</ul>
                    </section>
                </section>
                
                
                <section>
                    <section>
	                    <h1>Les formulaires</h1> 
                    </section>
                    
                    <section>
                    	<ul>
		                    <li>Conçu pour CRUD donc gestion formulaires obligatoire</li>
		                    <li>Details et démo ng-model, ngModelOptions et ngMessage</li>
                    	</ul>
                    </section>
                </section>
                
                
                <section>
                    <section>
                    	<h1>Les animations</h1> 
                    </section>
                    
                    <section>
	                    <p>Découplées et réutilisables</p>
	                    <p>Animations CSS et JS supportées</p>
	                    
	                    <p>Ajout module ngAnimate</p>
	                    <p>Ajoute des classes</p>
	                    
	                    
	                    <p>Exemple</p>
	                    <p>Animation CSS fait main</p>
	                    <p>Animation CSS avec Animate.css</p>
	                    <p>Animation JS avec GreenSock</p>
                    </section>
                </section>
                
                
                
                
                <section>
                    <section>
                    	<h1>Les tests</h1>
                    </section>
                    
                    <section>
	                    <p>Conçu pour pouvoir tester facilement</p>
	                    <p>Tests unitaires: Karma (Application NodeJS pour faire tourner les tests) + Jasmine (Framework pour écrire les tests) + ngMock (module pour faire des mocks)</p>
	                    <p>Tests E2E (End to End): Protractor</p>
                    </section>
                </section>
                
                
                
                
                
                
                
                
                
                
                <section>
                    <h1>Les TE</h1>
                    <iframe data-src="http://embed.plnkr.co/MOsXBm/preview" width="1000" height="700"></iframe>
                </section>
                
            

            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>

            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                //width: 1200,
                //height: 900,
                
                controls: true,
                progress: true,
                history: true,
                center: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true }
                ]
            });

        </script>

    </body>
</html>
