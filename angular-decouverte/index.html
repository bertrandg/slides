<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Formation AngularJS - Découverte du framework</title>

        <meta name="description" content="Formation AngularJS - Découverte du framework">
        <meta name="author" content="Bertrand Gaillard">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/beige.css" id="theme">

        <!-- Code syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>
        <style>
        .reveal pre code {
            //max-height: 500px;
        }
        .reveal blockquote {
            width: 90%;
        }
        .reveal pre {
            font-size: .45em;
        }
        .reveal p > code,
        .reveal blockquote > code,
        .reveal li > code {
            color: #8b743d;
        }
        .reveal .credits-link {
            font-size: .35em;
            display: block;
        }
        </style>
    

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                
                  <section>
                    <h1>Formation AngularJS</h1>
                    <h2>Découverte du framework</h2>
                    <small><a href="http://bertrandg.github.io/">Bertrand GAILLARD</a></small>
                  </section>
                
                
                
                <section>
                    <section>
                        <h1>Déclaratif plutôt qu’impératif</h1>
                    </section>
                    
                    <section>
                        <div>
                        <p>jQuery/BackboneJS = impératif, le JS commande l'HTML</p>
<pre><code><button id="mapBtn">Afficher la carte</button></code></pre>
<pre><code>$('#mapBtn').on('click', function(event) {
  // do something
});</code></pre></div>
                        <div class="fragment">
                        <p>AngularJS = déclaratif, le HTML commande le JS</p>
<pre><code><button ng-click="showMap()">Afficher la carte</button></code></pre>
<pre><code>$scope.showMap() {
  // do something
}</code></pre></div>
                        <br>
                        <p class="fragment">impératif = difficile à organiser et maintenir</p>
                        <p class="fragment">déclaratif = plus simple à lire et moins de code</p>
                    </section>
                    
                    <section>
                        <h2>Plus maintenable</h2>
                        <ul>
                            <li>
                                <p><code>#id</code> et <code>.class</code> ne sont plus utilisés dans le JS.</p>
                                <p>Dans le code HTML, on a:</p>
                                <ul>
                                    <li class="fragment">Pour le CSS, on a les <code>#id</code> et <code>.class</code></li>
                                    <li class="fragment">Pour le JS, on a les directives Angular ou personnalisées</li>
                                </ul>
                            </li>
                            <li>
                                <p class="fragment">CSS et JS ne sont plus liés du tout.</p>
                                <p class="fragment">Aucun/moins de risque d'erreur de:</p>
                                <ul>
                                    <li class="fragment">Casser des sélécteurs JS en travaillant sur le style</li>
                                    <li class="fragment">Casser des sélécteurs CSS en travaillant sur le javascript</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                </section>
                
                
                
                <section>
                    <section>
                        <h1>Etendre le language HTML</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Utilisation de nouvelles balises et attributs HTML</li>
                            <li class="fragment">Angular parse le DOM et interpréte ces éléments</li>
                            <li class="fragment">Pas de syntaxe de template spéciale, c'est du HTML!</li>
                        </ul>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h1>C'est quoi une application AngularJS?</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>
                                <p>Une partie du DOM sur laquelle on a mis l'attribut <code>ng-app</code>:</p>
<pre><code><div ng-app="testApp">..</div></code></pre>
                            </li>
                            <li class="fragment">
                                <p>Autre moyen de démarrer une application en passant par javascript:</p>
<pre><code><div id="divApp">..</div></code></pre>
<pre><code>angular.bootstrap(document.getElementById('divApp'), ['testApp']);</code></pre>
                            </li>
                            <li class="fragment">
                                <p>Possibilité de mettre plusieurs applications sur la même page.</p>
                            </li>
                            <li class="fragment">
                                <p>Parse la partie du DOM et exécute les directives qu'il trouve en ajoutant des templates, exécutant du JS,..</p>
                            </li>
                        </ul>
                    </section>
                    
                </section>
                
                
                <section>
                    <section>
                        <h1>Un framework MVC</h1>
                    </section>
                    
                    <section>
                        <img data-src="images/mvc.png"/>
                        
                        <a href="http://swiip.github.io/yeoman-angular" target="_blank" class="credits-link">http://swiip.github.io</a>
                    </section>
                    
                    <section>
                        <h2>Les controllers et les scopes</h2>
                        
                        <ul>
                            <li>Toujours liés entre eux.</li>
                            <li>Le scope est la glue entre controlleur et vue.</li>
                            <li>Le scope est un simple objet JS sur lequel on ajoute valeurs et méthodes.</li>
                            <li>Nouvelle instance créée à la volée au besoin puis détruite quand plus utile (pas de persistance).</li>
                            <li>Aucune manipulation de DOM dans les <code>controllers</code>.</li>
                        </ul>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Pour chaque <code>ngApp</code>, un <code>$rootScope</code> est créé, puis chaque controlleur crée un <code>scope</code> descendant, ce qui créé une arborescence.</li>
                            <li>Chaque <code>$scope</code> peut accéder à son parent grâce à <code>$scope.$parent</code>.</li>
                        </ul>
                        
                        <pre><code><div ng-app="scopeExample">
  <div class="show-scope-demo">
    <div ng-controller="GreetController">
      Hello {{name}}!
    </div>
    <div ng-controller="ListController">
      <ol>
        <li ng-repeat="name in names">{{name}} from {{department}}</li>
      </ol>
    </div>
  </div>
</div></code></pre>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Dans le JS, chaque <code>scope</code> hérite des propriétés et méthodes de ses parents grâce au prototypage.</li>
                            <li>Dans le DOM, on retrouve également cet imbrication/arborescence des <code>scopes</code> / <code>controllers</code>.</li>
                        </ul>
                        
                        <img data-src="images/concepts-scope.png"/>
                        <a href="https://docs.angularjs.org/guide/scope" target="_blank" class="credits-link">https://docs.angularjs.org/guide/scope</a>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h1>Les events</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>S'emettent et s'interceptent à partir des <code>scopes</code>.</li>
                            <li>Permet passer des informations d'un <code>scope</code> à un autre.</li>
                            <li>Comprend un nom unique pour toute l'application et une liste d'arguments.</li>
                            <li>A utiliser avec modération.</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>2 méthodes pour émettre un évènement</h2>
                        
                        <ul>
                            <li>
                                <p><code>$emit</code></p>
                            </li>
                            <li>
                                <p><code>$broadcast</code></p>
                            </li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>$emit</h2>
                        
                        <p>L'<code>event</code> remonte la hiérarchie des <code>scopes</code> jusqu'au <code>$rootScope</code> et peut être intercepté par chacun d'entre eux.</p>
                        
                        <pre><code>$scope.$emit('player.events.playVideo', video);</code></pre>

                        <img data-src="images/scope_emit.png"/>
                        <a href="http://www.frangular.com/2013/01/angularjs-scopes-et-evenements.html" target="_blank" class="credits-link">http://www.frangular.com/</a>
                    </section>
                    
                    <section>
                        <h2>$broadcast</h2>
                        <p>L'<code>event</code> descend chaque branche de la hiérarchie des <code>scopes</code> en partant du <code>$ccope</code> émetteur et peut être intercepté par chacun d'entre eux.</p>
                        
                        <pre><code>$scope.$broadcast('player.events.playVideo', video)</code></pre>
                        
                        <img data-src="images/scope_broadcast.png"/>
                        <a href="http://www.frangular.com/2013/01/angularjs-scopes-et-evenements.html" target="_blank" class="credits-link">http://www.frangular.com/</a>    
                    </section>
                    
                    <section>
                        <h2>Interception avec $on</h2>
                        
                        <pre><code>$scope.$on('player.events.playVideo', function(event, video) {
  $scope.playingVideo = video;
});</code></pre>
                        
                        <img data-src="images/scope_broadcast.png"/>
                        <a href="http://www.frangular.com/2013/01/angularjs-scopes-et-evenements.html" target="_blank" class="credits-link">http://www.frangular.com/</a>    
                    </section>
                    
                    <section>
                    <pre><code>app.controller('MainController', function($scope, $rootScope) {
  $scope.mainData = {
    logs: ''
  };
  
  $scope.$on('eventEmitedName', function(event, data) {
    $scope.mainData.logs = $scope.mainData.logs + '\nMainController - receive EVENT "' + event.name + '" with message = "' + data.message + '"';
  });
  
  $rootScope.$on('eventEmitedName', function(event, data) {
    $scope.mainData.logs = $scope.mainData.logs + '\n$rootScope - receive EVENT "' + event.name + '" with message = "' + data.message + '"';
  });
});

app.controller('ParentController', function($scope) {
  $scope.parentData = {
    message: 'messageAAA'
  };
  
  $scope.broadcastEvent = function() {
    $scope.$broadcast('eventBroadcastedName', $scope.parentData);
  };
  
  $scope.$on('eventEmitedName', function(event, data) {
    $scope.mainData.logs = $scope.mainData.logs + '\nParentController - receive EVENT "' + event.name + '" with message = "' + data.message + '"';
  });
});

app.controller('ChildController', function($scope) {
  $scope.childData = {
    message: 'messageBBB'
  };
  
  $scope.emitEvent = function() {
    $scope.$emit('eventEmitedName', $scope.childData);
  };
  
  $scope.$on('eventBroadcastedName', function(event, data) {
    $scope.mainData.logs = $scope.mainData.logs + '\nChildController - receive EVENT "' + event.name + '" with message = "' + data.message + '"';
  });
});</code></pre>
                        <a href="http://plnkr.co/edit/am6IDw?p=preview" target="_blank">http://plnkr.co/edit/am6IDw?p=preview</a>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h1>Le data-binding</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Synchronisation automatique entre le modèle et la vue.</li>
                            <li class="fragment">
                                <p>Unidirectionnel avec <code>ngBind</code> / <code>{{ }}</code>.</p>
                                <pre><code><p>{{ user.firstname }}</p></code></pre>
                            </li>
                            <li class="fragment">
                                <p>Bidirectionnel avec <code>ngModel</code>.</p>
                                <pre><code><input ng-model="user.firstname" /></code></pre>
                            </li>
                            <li class="fragment">Terminé les sélecteurs CSS dans le JS.</li>
                            <li class="fragment">Evite de (trés) nombreuses lignes de code JS.</li>
                            <li class="fragment">Surcouche qui évite un grand nombre d'erreurs.</li>
                        </ul>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h1>Les directives</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Permet d'étendre le language HTML.</li>
                            <li>Permet d'encapsuler du JS et de l'HTML dans une "boite noire".</li>
                            <li>Va dans le sens des futurs standards du web (WebComponents, Polymer).</li>
                            <li>Génial pour la réutilisation, le partage, le travail en équipe, les tests,..</li>
                            <li>Une des parties les plus puissantes mais aussi difficiles.</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>Directives peuvent prendre 4 formes:</h2>
                        <ul>
                            <li>
                                Elément/Tag
                                <pre><code><my-directive></my-directive></code></pre>
                            </li>
                            <li>
                                Attribut
                                <pre><code><span my-directive></span></code></pre>
                            </li>
                            <li>
                                Commentaire
                                <pre><code><!-- directive: my-directive --></code></pre>
                            </li>
                            <li>
                                Classe
                                <pre><code><span class="my-directive"></span></code></pre>
                            </li>
                        </ul>
                    </section>
                        
                    <section>
                        <ul>
                            <li>directives natives commencent par ng- (conventions)</li>
                            <li>bien de mettre son prefix (conventions)</li>
                            <li>avec des tirets dans l'HTML (ng-click) et en camelCase en JS (ngClick)</li>
                            <li>possibilité de écrire sous différentes formes dans l'HTML:</li>
                        </ul>
                        
                        <pre><code>
<span ng-bind="name"></span>
<span ng:bind="name"></span>
<span ng_bind="name"></span>
<span data-ng-bind="name"></span>
<span x-ng-bind="name"></span>
                        </code></pre>
                    </section>
                        
                    <section>
                        <h2>Directives simples:</h2>
                        <ul>
                            <li>ng-bind / {{ }}</li>
                            <li>ng-click / ngDblclick / ngMouseenter / ..</li>
                            <li>ng-class</li>
                            <li>ng-show / ng-hide</li>
                            <li>ng-init</li>
                            <li>ng-model</li>
                            <li>ng-focus</li>
                        </ul>
                    </section>
                        
                    <section>
                        <h2>Directives créant un nouveau scope:</h2>
                        <ul>
                            <li>ng-controller</li>
                            <li>ng-if</li>
                            <li>ng-include</li>
                            <li>ng-switch</li>
                            <li>ng-repeat</li>
                        </ul>
                    </section>
                </section>
                
                
                
                
                <section>
                    <section>
                        <h1>Les modules</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Permet un découpage de l'application.</li>
                            <li class="fragment">Découpage par fonctionnalité préconisé.</li>
                            <li class="fragment">Ne sert pas de namespace.</li>
                            <li class="fragment">Le framework lui-même découpé en modules: <code>ngRoute</code>, <code>ngAnimate</code>, <code>ngMock</code>,..</li>
                            <li class="fragment">Tous instanciés au démarrage (pas de lazy loading)</li>
                        </ul>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Application AngularJS = Un module principal + modules dont le principal dépend.</li>
                        </ul>
                        
                        <div>
                            <p>Déclaration de module:</p>
                            <pre><code>angular.module('myapp', ['myapp.feature1'
                        'myapp.feature2',
                        'ng-route',
                        'ng-animate'
                        'ui-router']);</code></pre>
                        </div>
                        <div>
                            <p>Récupération de module:</p>
                            <pre><code>angular.module('myapp');</code></pre>
                        </div>
                    </section>
                    
                    <section>
                        <p>Tous les controlleurs, directives, filters et services sont déclarées sur un module.</p>
                        <img data-src="images/module-diagram.jpg" style="transform: scale(.8);"/>
                        <a href="http://www.manning.com/aden/" target="_blank" class="credits-link">http://www.manning.com/aden/</a>
                        
                        <p>Exemple:</p>
                        <pre><code>angular.module('myapp', ['myapp.utils', 'myapp.gallery']);
angular.module('myapp').controller('HomeCtrl', function() {});
angular.module('myapp').service('myService', function() {});

angular.module('myapp.gallery', []);
angular.module('myapp.gallery').controller('GalleryCtrl', function() {});

angular.module('myapp.utils', []);
angular.module('myapp.utils').constant('myFilter', {});
angular.module('myapp.utils').filter('myFilter', function() {});</code></pre>
                    </section>
                    
                    <section>
                        <h2>Au chargement de chaque module:</h2>
                        
                        <ul>
                            <li>Exécution des <code>config()</code> puis des <code>run()</code>.</li>
                            <li>On peut affecter autant de <code>config()</code> et de <code>run()</code></li>
                            <li>Exécuté avant tous les controlleurs, directives, filtres,..</li>
                        </ul>
                        
                        <pre><code>angular.module('myapp', []);
                        
angular.module('myapp').config(function($httpProvider) {
    // Injection des providers des services
    // (objets servant en interne à créer les instances des services)
    // et de les configurer avant leur instanciation
    $httpProvider.defaults.headers.common['Access-Control-Max-Age'] = '1728000';
    $httpProvider.defaults.headers.common['Accept'] = 'application/json, text/javascript';
    $httpProvider.defaults.headers.common['Content-Type'] = 'application/json; charset=utf-8';
});

angular.module('myapp').run(function($http) {
  // Injection des instances des services pour utilisation
  $http.post('/someUrl', {msg:'appStart'});
});</code></pre>
                        
                    </section>
                </section>
                
                
                
                <section>
                    <section>
                        <h1>Les services</h1>
                    </section>
                        
                    <section>
                        <ul>
                            <li>Un service = simple objet JS avec propriétés et méthodes</li>
                            <li>Utilise l'injection de dépendances.</li>
                            <li>Créé une seule fois lors du premier appel (Singleton).</li>
                            <li>Réutilisé lors des suivants pour toute la durée de vie de la SPA.</li>
                            <li>Accessible de partout quelque soit le module sur lequel ils sont créés ou appelés.</li>
                            <li>Peut être injecté dans controlleurs, filtres, services,..</li>
                            <li>Utilisation à volonté pour alléger au maximum les controlleurs.</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>Fonctionnement interne de DI</h2>
                        <ul>
                            <li>Chaque service vient avec un provider qui sert à le créer.</li>
                            <li>A l'initialisation d'un module, tous les providers des services sont réferencés.</li>
                            <li>C'est seulement lors de sa première injection que l'instance du service est créée grâce à son provider.</li>
                            <li>Lors des injections suivantes, Angular fournit directement l'instance, plus besoin du provider.</li>
                        </ul>
                        
                        <blockquote>Dans la pratique, chaque provider posséde une méthode <code>$get</code> qui retourne l'instance et peut comporter des propriétés ou méthodes servant à configurer l'instanciation du service associé.</blockquote>
                    </section>
                    
                    <section>
                        <h2>Différentes déclarations de services</h2>
                        <p>Il existe 5 méthodes pour déclarer un service mais dans tous les cas, ils s'injectent et s'utilisent de la même manière et il en existe toujours une seule instance.</p>
                        <ul>
                            <li>module.provider()</li>
                            <li>module.factory()</li>
                            <li>module.service()</li>
                            <li>module.value()</li>
                            <li>module.constant()</li>
                        </ul>
                        <p><code>factory()</code> et <code>service()</code> sont juste des manières plus simples d’écrire un <code>provider()</code>.</p>
                    </section>
                    
                    <section>
                        <h2>1/5: PROVIDER()</h2>
                        <ul>
                            <li>Permet de paramétrer le service au démarrage du module.</li>
                            <li>Fonction <code>$get</code> obligatoire retournant l'instance du service.</li>
                        </ul>
                    
                        <pre><code>var app = angular.module('myapp');
                        
app.provider('MyService', function() {
    var scale = 1;
    
    this.setScale = function(newScale) {
      scale = newScale;
    };
    
    this.$get = function ($window) {
        return {
            getScreenWidth: function() {
                return $window.innerWidth * scale;
            },
            getScreenHeight: function() {
                return $window.innerHeight * scale;
            }
        };
    };
});

app.config(function(MyServiceProvider) {
  MyServiceProvider.setScale(10);
});

app.controller('AppCtrl', function($scope, MyService) {
  var _width = MyService.getScreenWidth();
});</code></pre>
                    </section>
                    
                    <section>
                        <h2>2/5: FACTORY()</h2>
                        <ul>
                            <li>Simplification de la méthode <code>provider()</code>.</li>
                            <li>Equivalent à la méthode <code>$get</code> précédente.</li>
                            <li>Provider automatiquement créé par Angular.</li>
                        </ul>
                        
                        <pre><code>app.factory('MyService', function($window) {
    var scale = 1;
    
    return {
        getScreenWidth: function() {
            return $window.innerWidth * scale;
        },
        getScreenHeight: function() {
            return $window.innerHeight * scale;
        }
    };
});

app.controller('AppCtrl', function($scope, MyService) {
  var _width = MyService.getScreenWidth();
});</code></pre>
                    </section>
                    
                    <section>
                        <h2>3/5: SERVICE()</h2>
                        <ul>
                            <li>Simplification de la méthode <code>provider()</code>.</li>
                            <li>Fonction directement instanciée avec un <code>new</code> pour créer l'instance du service.</li>
                            <li>Pas besoin de <code>return</code> un objet, tout ce qui est attaché à <code>this</code> sera accessible par le biais du service.</li>
                        </ul>
                        
                        <pre><code>app.service('MyService', function($window) {
    var scale = 1;
    
    this.getScreenWidth = function() {
        return $window.innerWidth * scale;
    };
    
    this.getScreenHeight = function() {
        return $window.innerHeight * scale;
    }
});

app.controller('AppCtrl', function($scope, MyService) {
  var _width = MyService.getScreenWidth();
});</code></pre>
                    </section>
                    
                    <section>
                        <h2>4/5: VALUE()</h2>
                        <ul>
                            <li>Stocker un objet JS de type <code>object</code> ou bien de type primitif (<code>booléen</code>, <code>string</code>, <code>number</code>).</li>
                            <li>Inaccessible par les <code>provider</code> lors de la phase de configuration du module.</li>
                            <li>Peut être modifié pendant l'éxecution de l'application.</li>
                            <li>Impossible d'utiliser l'injection de dépendances pour utiliser d'autres services.</li>
                        </ul>
                        
                        <pre><code>app.value('GoogleMapAPI_KEY', '5VUhR4kqvVvhXRH4BIAN')

app.value('VideoData', {
    title: 'Ters Akan şelale!',
    description: 'Bu işte bir yanlışlık var diye İngiltere',
    url: 'http://www.dailymotion.com/video/x28i2n3_ters-akan-selale_news'
})

app.controller('AppCtrl', function($scope, VideoData) {
  $scope.video = VideoData;
});
</code></pre>
                    </section>
                    
                    <section>
                        <h2>5/5: CONSTANT()</h2>
                        <ul>
                            <li>Fonctionne comme <code>value()</code> mais est accessible lors de la phase de configuration du module.</li>
                            <li>Malgré leur nom, elles peuvent être modifiée.</li>
                        </ul>
                        
                        <pre><code>app.constant('UselessData', {
    scale: 42
});

app.config(function(MyServiceProvider, UselessData) {
  MyServiceProvider.setScale(UselessData.scale);
});

app.controller('AppCtrl', function($scope, UselessData) {
  $scope.scale = UselessData.scale;
});
</code></pre>
                    </section>
                    
                    <section>
                    <h2>Exemple de déclaration de services:</h2>
                    
<pre><code>playerApp.value('Params', {
  URL_API: 'https://api.dailymotion.com/videos',
  URL_EMBED: 'http://www.dailymotion.com/embed/video',
  VIDEOS_PER_PAGE: 12,
  VIDEOS_AUTOPLAY: true,
});

playerApp.factory('Dailymotion', function($http, $sce, Params) {
  var getApiUrl = function(terms, page) {
      var api_params =  '?fields=id,title,description,duration_formatted,created_time&sort=relevance';
      var api_limit =   '&limit=' + Params.VIDEOS_PER_PAGE;
      var api_page =    '&page=' + page;
      var api_search =  '&search=' + terms.split(' ').join('+');
      var api_jsonp =   '&callback=JSON_CALLBACK';
    
    return Params.URL_API + api_params + api_limit + api_page + api_search + api_jsonp;
  };
  
  var Service = {
    getResults: function(terms, page) {
      return $http({
        method: 'JSONP',
        url: getApiUrl(terms, page),
        cache: true,
        transformResponse: function (data, headers) {
          data.nbPages = Math.ceil(data.total / data.limit);
          return data;
        }
      });
    },
    
    getIframeUrl: function(videoId) {
          var url = Params.URL_EMBED + '/' + videoId + '?autoPlay=' + Params.VIDEOS_AUTOPLAY;
          return $sce.trustAsResourceUrl(url);
    }
  };
  
  return Service;
});</code></pre>
                    </section>
                        
                        
                    <section>
                        <p>Exemple d'utilisation de services:</p>
                        
<pre><code>playerApp.controller('VideoPlayerModalCtrl', function($scope, $modalInstance, Dailymotion, video) {
  $scope.video = video;
  $scope.iframeUrl = Dailymotion.getIframeUrl(video.id);
  
  $scope.close = function () {
    $modalInstance.close();
  };
});</code></pre>
                        <blockquote>En pratique, <code>factory()</code> et <code>value()</code> sont utilisés dans la plupart du cas.</blockquote>
                    </section>
                        
                        
                    <section>
                        <h2>Services fournis par AngularJS</h2>
                        
                        <p>$http, $location, $filter, $window, $timeout, $interval, $animate, $rootScope, $document,..</p>
                        
                        <ul>
                            <li>Commencent tous par $ (conventions)</li>
                            <li>Couche d'abstraction utile pour fonctionner dans l'écosystéme AngularJs et pour être mockée lors des tests.</li>
                            <li><code>Providers</code> associés pour les configurer au démarrage:</li>
                        </ul>
                        
                        <p>$httpProvider, $locationProvider, $filterProvider, $animateProvider, $rootScopeProvider,..</p>
                        
                    </section>
                        
                </section>
                
                
                
                
                <section>
                    <section>
                        <h1>Les filtres</h1>
                    </section>
                        
                    <section>
                        <ul>
                            <li>Fonction qui transforme un input en output.</li>
                            <li>Utilisation similaires à Twig.</li>
                            <li>Stateless = si la données à transformer ne change pas, le filtre ne sera pas réexeutée.</li>
                            <li>Utilisation en HTML ou en JS.</li>
                    </section>
                        
                    <section>
                        <h2>Création d'un filtre:</h2>
                        <pre><code>app.filter('truncate', function() {
  return function(str, nbChar) {
    return str.substring(0, nbChar);
  };
});
                        </code></pre>
                    </section>
                        
                    <section>
                        <h2>Utilisation HTML d'un filtre:</h2>
                        <pre><code><p>{{ description | truncate:10 }}</p>
<p ng-bind="description | truncate:10"></p></code></pre>

                        <p>Possibilité de les cumuler:</p>
                        <pre><code><p>{{ data | filterA:param1 | filterB | filterC:param1:param2 }}</p></code></pre>
                    </section>
                        
                    <section>
                        <h2>Utilisation JS d'un filtre:</h2>
                        <pre><code>app.controller('MainCtrl', function($scope, $filter) {
  var longText = 'Trés long texte, trés long texte, trés long texte';
  
  $scope.filteredText = $filter('truncate')(longText, 10);
});</code></pre>
                        <pre><code>app.controller('MainCtrl', function($scope, truncateFilter) {
  var longText = 'Trés long texte, trés long texte, trés long texte';
  
  $scope.filteredText = truncateFilter(longText, 10);
});</code></pre>
                    </section>
                    
                    <section>
                        <h2>Filtres natifs: date, uppercase, json,..</h2>
                        
                        <pre><code>{{ today | date:'short' }}      <!-- 1/24/14 12:09 PM -->
{{ today | date:'yyyy' }}       <!-- 2014 -->

{{ 789123.4567 | number:2 }}    <!-- 789,123.46 -->

{{ 123 | currency }}            <!-- 123$ -->

{{ 'Vincent' | uppercase }}     <!-- VINCENT -->
{{ 'Vincent' | lowercase }}     <!-- vincent -->
{{ 'Je fais un essai' | limitTo: 2}}        <!-- Je -->
{{ 'Je fais un essai' | limitTo: -5}}       <!-- essai -->

{{ [1, 2, 3, 4] | limitTo: 2}}              <!-- [1,2] -->
{{ ['alpha', 'beta', 'gamma'] | filter:'e' }}   <!-- ['beta'] -->

{{  [{'nom': 'Nabet', 'prenom':'Vincent'},
     {'nom': 'Van Gogh', 'prenom':'Vincent'}] | filter:{'nom':'Nabet'}:true }}
     <!-- {'nom': 'Nabet', 'prenom':'Vincent'} -->  <!-- Rq: $ comme jocker clé -->

{{ ['alpha', 'beta', 'gamma'] | filter:fourCharac }}   <!-- ['beta'] --></code></pre>
<pre><code>$scope.fourCharac = function(elem) { return elem.length === 4;}</code></pre>
                    </section>
                </section>
                
                <section>
                    <section>
                        <h1>Les promesses</h1>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Promise = objet JS correspondant au résultat différé d'une opération asynchrone.</li>
                            <li>Trés utilisée dans l'écosystéme AngularJS.</li>
                            <li>Plus souple que les callbacks.</li>
                            <li>Possibilité des les imbriquer.</li>
                            <li>Gestion des erreurs.</li>
                        </ul>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Les services <code>$http</code> et <code>$timeout</code> retournent une promesse.</li>
                        </ul>
                    <pre><code>app.controller('AppController', function($scope, $timeout) {
  var promise = $timeout(3000);
  
  $scope.name = 'waiting promise resolve';
  
  promise.then(function() {
    $scope.name = 'resolved!';
  });
});</code></pre>
                    <a href="http://plnkr.co/edit/sYinVP?p=preview" target="_blank">http://plnkr.co/edit/sYinVP?p=preview</a>
                    
                    <pre><code>app.controller('GreetController', function($scope, $http) {
  var promise = $http.get('https://api.github.com/users/bertrandg');
  
  promise.then(function(response) {
    $scope.user = response.data;
  }, function(reason) {
    $scope.error = reason;
  });
  
  $scope.loading = true;
  promise.finally(function(){
    $scope.loading = false;
  });
});</code></pre>
                    <a href="http://plnkr.co/edit/7fbtsQ?p=preview" target="_blank">http://plnkr.co/edit/7fbtsQ?p=preview</a>
                    </section>
                    
                    <section>
                        <ul>
                            <li>Création de promesses grâce au service $q.</li>
                        </ul>
                    <pre><code>app.factory('MaPromesse', function($q, $timeout) {
  
  var Service = {
    get: function() {
      var deferred = $q.defer();
      
      $timeout(3000).then(function() {
        //deferred.resolve("terminé !");
        deferred.reject("terminé mais mal !");
      });
      
      return deferred.promise;
    }
  };
  
  return Service;
});

app.controller('GreetController', function($scope, MaPromesse) {
  
  MaPromesse.get().then(function(data) {
    $scope.data = data;
  }, function(reason) {
    $scope.data = reason;
  });
});</code></pre>
                    <a href="http://plnkr.co/edit/wo4DNu?p=preview" target="_blank">http://plnkr.co/edit/wo4DNu?p=preview</a>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h1>Les formulaires</h1> 
                    </section>
                    
                    <section>
                        <ul>
                            <li>Validation de formulaire trés simple.</li>
                            <li>Permet de fournir des indications visuelles à l'utilisateur.</li>
                            <li>Permet de controler les données entrées par l'utilisateur.</li>
                            <li>Ne dispense pas des validations serveurs evidemment!</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>Comment ça se passe?</h2>
                        
                        <ul>
                        	<li>Grâce au pouvoir des directives, tous les éléments HTML du formulaire sont 'étendus' pa Angular:<br>
                        	<code>form</code>, <code>input</code>, <code>button</code>,..</li>
                        	<li>Ainsi que tous les attributs de validation HTML5:<br>
                        	<code>required</code>, <code>min="4"</code>,..</li>
                        	<li>En bonus, Angular ajoute des directives de validation: <code>ng-pattern="/^[a-zA-Z]+$/"</code>, <code>ng-maxlength=20</code>,..</li>
                            <li>En méga bonus, vous pouvez créer vos propres directives de validation, y compris asynchrones!</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>Exemple</h2>
                        
                    	<pre><code>app.controller('MainController', function($scope) {
  $scope.newUser = {
    firstname: '',
    lastname: '',
    email: '',
    website: ''
  };
  
  $scope.createUser = function(user) {
    alert('nouveau user valide prêt!');
  };
});</code></pre>
                    	<pre><code><form name="registerForm" ng-submit="createUser(newUser)" novalidate>
  <input name="prenom"    ng-model="newUser.firstname"   type="text" ng-minlength=4 required />
  <input name="nom"       ng-model="newUser.lastname"    type="text" ng-minlength=4 required />
  <input name="courriel"  ng-model="newUser.email"       type="email" required />
  <input name="siteweb"   ng-model="newUser.website"     type="url" required />
      
  <button type="submit" ng-disabled="registerForm.$invalid">Envoyer</button>
</form></code></pre>
						<a href="http://plnkr.co/edit/0oFGvN?p=preview" target="_blank">http://plnkr.co/edit/0oFGvN?p=preview</a>
                    </section>
                    
                    <section>
                        <h2>Etats et erreurs du formulaire</h2>
                        
                        <p>Le formulaire et chaque champ ont des booléens assignés:</p>
                        
                        <ul>
                        	<li><code>$dirty</code>: Champ ou formulaire déjà modifié.</li>
                        	<li><code>$pristine</code>: Champ ou formulaire pas encore modifié.<br></li>
                        	<li><code>$valid</code>: Champ ou formulaire valide.</li>
                        	<li><code>$invalid</code>: Champ ou formulaire invalide.</li>
                        	<li><code>$error</code>: Erreurs courante du champ ou formulaire.</li>
                        </ul>
                        
                    	<pre><code>$scope.registerForm.$valid; /* true si formulaire valide */
$scope.registerForm.nom.$invalid; /* true si champ nom n'est pas valide */
$scope.registerForm.courriel.$dirty; /* true si champ courriel n'a pas encore été 'utilisé' */

$scope.registerForm.prenom.$error.required; /* true si validation required du champ prenom non remplie */
$scope.registerForm.courriel.$error.email; /* true si validation email du champ courriel non remplie */</code></pre>
                    </section>
                    
                    <section>
                        <p>Affichage des erreurs</p>
                        
                    	<pre><code><form name="registerForm" ng-submit="createUser(newUser)" novalidate>
  
  <div>
    <label>Prénom:</label>
    <input name="prenom" ng-model="newUser.firstname" type="text" ng-minlength=4 required />
    <p ng-show="registerForm.prenom.$dirty && registerForm.prenom.$error.required">Prénom requis!</p>
    <p ng-show="registerForm.prenom.$dirty && registerForm.prenom.$error.minlength">Prénom doit faire 4 caractéres minimum!</p>
  </div>
  
  <div>
    <label>Nom:</label>
    <input name="nom" ng-model="newUser.lastname" type="text" ng-minlength=4 required />
    <p ng-show="registerForm.nom.$dirty && registerForm.nom.$error.required">Nom requis!</p>
    <p ng-show="registerForm.nom.$dirty && registerForm.nom.$error.minlength">Nom doit faire 4 caractéres minimum!</p>
  </div>
  
  <div>
    <label>Courriel:</label>
    <input name="courriel" ng-model="newUser.email" type="email" required />
    <p ng-show="registerForm.courriel.$dirty && registerForm.courriel.$error.required">Courriel requis!</p>
    <p ng-show="registerForm.courriel.$dirty && registerForm.courriel.$error.email">Courriel doit contenir @ et..!</p>
  </div>
  
  <div>
    <label>Site web:</label>
    <input name="siteweb" ng-model="newUser.website" type="url" required />
    <p ng-show="registerForm.siteweb.$dirty && registerForm.siteweb.$error.required">Site web requis!</p>
    <p ng-show="registerForm.siteweb.$dirty && registerForm.siteweb.$error.url">Site web doit être de la forme http://..!</p>
  </div>
  
  <button type="submit" ng-disabled="registerForm.$invalid">Envoyer</button>
</form></code></pre>
						<a href="http://plnkr.co/edit/Wix7sD?p=preview" target="_blank">http://plnkr.co/edit/Wix7sD?p=preview</a>
                    </section>
                    
                    <section>
                    	<p>Encore mieux, le module ngMessages</p>
                    	
                    	<pre><code><script src="https://code.angularjs.org/1.3.14/angular-messages.js"></script></code></pre>
                    	
                    	<pre><code>var app = angular.module('myApp', ['ngMessages']);</code></pre>
                    	
                    	<pre><code><form name="registerForm" ng-submit="createUser(newUser)" novalidate>
  
  <div>
    <label>Prénom:</label>
    <input name="prenom" ng-model="newUser.firstname" type="text" ng-minlength=4 required />
    
    <ng-messages for="registerForm.prenom.$error" ng-show="registerForm.prenom.$dirty">
      <p ng-message="required">Prénom requis!</p>
      <p ng-message="minlength">Prénom doit faire 4 caractéres minimum!</p>
    </ng-messages>
  </div>
  
  <div>
    <label>Nom:</label>
    <input name="nom" ng-model="newUser.lastname" type="text" ng-minlength=4 required />
    <ng-messages for="registerForm.nom.$error" ng-show="registerForm.nom.$dirty">
      <p ng-message="required">Nom requis!</p>
      <p ng-message="minlength">Nom doit faire 4 caractéres minimum!</p>
    </ng-messages>
  </div>
  
  <div>
    <label>Courriel:</label>
    <input name="courriel" ng-model="newUser.email" type="email" required />
    <ng-messages for="registerForm.courriel.$error" ng-show="registerForm.courriel.$dirty">
      <p ng-message="required">Courriel requis!</p>
      <p ng-message="email">Courriel doit contenir @ et..!</p>
    </ng-messages>
  </div>
  
  <div>
    <label>Site web:</label>
    <input name="siteweb" ng-model="newUser.website" type="url" required />
    <ng-messages for="registerForm.siteweb.$error" ng-show="registerForm.siteweb.$dirty">
      <p ng-message="required">Site web requis!</p>
      <p ng-message="url">Site web doit être de la forme http://..!</p>
    </ng-messages>
  </div>
  
  <button type="submit" ng-disabled="registerForm.$invalid">Envoyer</button>
</form></code></pre>
						<a href="http://plnkr.co/edit/00vSyb?p=preview" target="_blank">http://plnkr.co/edit/00vSyb?p=preview</a>
                    </section>
                    
                    <section>
                    	<h2>Bonus</h2>
                    	
                        <p>Angular ajoute des classes CSS sur les <code>input</code> en fonction de leur état.</p>
                        
                        <pre><code>/* SASS */

form input {
  border-width: 4px;
  
  &.ng-dirty {
    &.ng-valid {
      border-color: green;
    }
    
    &.ng-invalid {
      border-color: red;
    }
  }
}</code></pre>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h1>Le routing</h1>
                    </section>
                    
                    <section>
                    	<h2>Différentes options possibles:</h2>
                    	
                        <ul>
                            <li>Module <code>ngRoute</code>: Basé sur les routes (#/posts/12), trés basique, pas de vue imbriquées, plus mis à jour.</li><br>
                            <li>Module <code>uiRouter</code>: Basé sur les states ('app.posts.details'), librairie remplaçante, beaucoup plus souple.</li><br>
                            <li>Module <code>ngNewRouter</code> Nouveau router qui arrive avec la version 1.4 et sera aussi utilisé dans Angular 2.</li>
                        </ul>
                    </section>
                    
                    <section>
                    	<h2>ngRoute</h2>
                    	
                    	<pre><code style="max-height: 300px;">app.config(function($routeProvider) {
  
  $routeProvider.when(
    '/page1', 
    {
      templateUrl: 'page1.tpl.html'
    }
  );
  
  $routeProvider.when(
    '/page2/:name',
    {
      controller: 'Page2Ctrl',
      templateUrl: 'page2.tpl.html'
    }
  );
  
  $routeProvider.when(
    '/pages3/article/:id',
    {
      controller: function($scope, $routeParams) {
        $scope.idArticle = $routeParams.id;
      },
      template:  '<div>\
                    <h1>PAGE3</h1>\
                    <p>Details de l\'article id: {{ idArticle }}</p>\
                  </div>'
    }
  );
  
  $routeProvider.otherwise({redirectTo: '/page1'});
});</code></pre>
                    	<pre><code><ul>
  <li><a href="#/page1">Page 1 (#/page1)</a></li>
  <li><a href="#/page2/bertrand">Page 2 (#/page2/bertrand)</a></li>
  <li><a href="#/page2/jack">Page 2 (#/page2/jack)</a></li>
  <li><a href="#/page3/article/65">Page 3 (#/page3/article/65)</a></li>
  <li><a href="#/page3/article/8">Page 3 (#/page3/article/8)</a></li>
</ul></code></pre>
						<a href="http://plnkr.co/edit/rFUxCD?p=preview" target="_blank">http://plnkr.co/edit/rFUxCD?p=preview</a>
                    </section>
                    
                    <section>
                    	<h2>uiRouter</h2>
                    	
                    	<pre><code style="max-height: 300px;">app.config(function($stateProvider, $urlRouterProvider) {
  
  $stateProvider.state(
    'app',
    {
      url: '/', 
      template: '<div ui-view></div>'
    }
  );
  
  $stateProvider.state(
    'app.page1',
    {
      url: 'page1/', 
      templateUrl: 'page1.tpl.html'
    }
  );
  
  $stateProvider.state(
    'app.page1.detailA',
    {
      url: 'detailA',
      template:  '<div>\
                    <h1>DETAILA</h1>\
                  </div>'
    }
  );
  
  $stateProvider.state(
    'app.page1.detailB',
    {
      url: 'detailB',
      template:  '<div>\
                    <h1>DETAILB</h1>\
                  </div>'
    }
  );
  
  $stateProvider.state(
    'app.page2',
    {
      url: 'page2/:name',
      controller: 'Page2Ctrl',
      templateUrl: 'page2.tpl.html'
    }
  );
  
  $stateProvider.state(
    'app.page3',
    {
      url: 'page3/article/:id',
      controller: function($scope, $stateParams) {
        $scope.idArticle = $stateParams.id;
      },
      template:  '<div>\
                    <h1>PAGE3</h1>\
                    <p>Details de l\'article id: {{ idArticle }}</p>\
                  </div>'
    }
  );
  
  $urlRouterProvider.otherwise('/page1');
});</code></pre>
                    	<pre><code><ul>
  <li><a ui-sref="app.page1">Page 1 (app.page1)</a></li>
  <li><a ui-sref="app.page1.detailA">Page 1 (app.page1.detailA)</a></li>
  <li><a ui-sref="app.page1.detailB">Page 1 (app.page1.detailB)</a></li>
  <li><a ui-sref="app.page2({name: 'bertrand'})">Page 2 (app.page2({name: 'bertrand'}))</a></li>
  <li><a ui-sref="app.page2({name: 'jack'})">Page 2 (app.page2({name: 'jack'}))</a></li>
  <li><a ui-sref="app.page3({id: 65})">Page 3 (app.page3({id: 65}))</a></li>
  <li><a ui-sref="app.page3({id: 8})">Page 3 (app.page3({id: 8}))</a></li>
</ul></code></pre>
						<a href="http://plnkr.co/edit/xSpKKD?p=preview" target="_blank">http://plnkr.co/edit/xSpKKD?p=preview</a>
                    </section>
                    
                    <section>
                    	<h2>ngNewRouter</h2>
                    	
                        <ul>
                            <li>Trés trés récent et encore en version béta.</li><br>
                            <li>Basé sur le principe des composants trés puissant.</li><br>
                            <li>Va être un élément clé pour la migration vers Angular 2.</li><br>
                        </ul>
                    	
                    </section>
                </section>
                
                
                
                <section>
                    <section>
                        <h1>Les animations</h1> 
                    </section>
                    
                    <section>
                        <p>Découplées et réutilisables</p>
                        <p>Animations CSS et JS supportées</p>
                        
                        <p>Ajout module ngAnimate</p>
                        <p>Ajoute des classes</p>
                        
                        
                        <p>Exemple</p>
                        <p>Animation CSS fait main</p>
                        <p>Animation CSS avec Animate.css</p>
                        <p>Animation JS avec GreenSock</p>
                    </section>
                </section>
                
                
                
                
                <section>
                    <section>
                        <h1>Les tests</h1>
                    </section>
                    
                    <section>
                        <p>Conçu pour pouvoir tester facilement</p>
                        <p>Tests unitaires: Karma (Application NodeJS pour faire tourner les tests) + Jasmine (Framework pour écrire les tests) + ngMock (module pour faire des mocks)</p>
                        <p>Tests E2E (End to End): Protractor</p>
                    </section>
                </section>
                
                
                
                
                
                
                
                
                
                
                <section>
                    <h1>Les TE</h1>
                    <iframe data-src="http://embed.plnkr.co/MOsXBm/preview" width="1000" height="700"></iframe>
                </section>
                
            

            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>

            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                //width: 1200,
                //height: 900,
                
                controls: true,
                progress: true,
                history: true,
                center: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true }
                ]
            });

        </script>

    </body>
</html>
